# Config file for Omnibus installed GitLab
# DO NOT EDIT! All changes will be overwritten
#
# Managed by Chef for <%= node['fqdn'] %>

# Settings
external_url = 'http<%= 's' if @config['ssl_enabled'] %>://<%= @config['site_url'] %>'
gitlab_rails['gitlab_email_from'] = '<%= @config['from_email'] %>'
gitlab_rails['gitlab_support_email'] = '<%= @config['support_email'] %>'
gitlab_rails['gitlab_default_can_create_group'] = <%= @config['user_can_create_groups'] %>
<%= "git_data_dir = '#{@config['repo_dir']}'" if @config['repo_dir'] -%>
<%= "gitlab_rails['backup_path'] = '#{@config['backup_path']}'" if @config['backup_path'] -%>

<% if @config['ldap_enabled'] -%>
# LDAP config
gitlab_rails['ldap_enabled'] = true
<%= "gitlab_rails['ldap_host'] = '#{@config['ldap_host']}'" if @config['ldap_host'] -%>
<%= "gitlab_rails['ldap_port'] = '#{@config['ldap_port']}'" if @config['ldap_port'] -%>
<%= "gitlab_rails['ldap_uid'] = '#{@config['ldap_uid']}'" if @config['ldap_uid'] -%>
<%= "gitlab_rails['ldap_method'] = '#{@config['ldap_method']}'" if @config['ldap_method'] -%>
<%= "gitlab_rails['ldap_bind_dn'] = '#{@config['ldap_bind_dn']}'" if @config['ldap_bind_dn'] -%>
<%= "gitlab_rails['ldap_password'] = '#{@config['ldap_password']}'" if @config['ldap_password'] -%>
<%= "gitlab_rails['ldap_allow_username_or_email_login'] = '#{@config['ldap_allow_username_or_email_login']}'" if @config['ldap_allow_username_or_email_login'] -%>
<%= "gitlab_rails['ldap_base'] = '#{@config['ldap_base']}'" if @config['ldap_base'] -%>
<% end -%>

<% if @config['ssl_enabled'] -%>
nginx['redirect_http_to_https'] = true
<% end -%>